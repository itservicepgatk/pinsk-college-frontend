<!doctype html><html lang=ru><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Портал колледжа - Администратор</title><link href=assets/images/favicon.ico rel=icon type=image/x-icon><link href=admin-style.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/sweetalert2@11></script><body><div id=maintenance-banner><strong>Внимание!</strong> На портале ведутся технические работы. Возможны временные ошибки и нестабильная работа.</div><div class=hidden id=admin-login-view-container></div><div class=hidden id=dashboard-container><div class=dashboard-header><h1 id=dashboard-title>Группы</h1><div><button id=logout-button>Выйти</button></div></div><div class=dashboard-stats><div class=stat-card><div class=stat-label>Всего учащихся</div><div class=stat-value id=total-learners-stat>...</div><button class=btn-details id=details-btn>Подробнее</button></div><div class=stat-card><div class=stat-label>Учащихся с задолженностями</div><div class=stat-value id=debtors-count-stat>...</div><button class=btn-details id=details-debtors-btn>Подробнее</button></div></div><div id=groups-view><div style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));" class=main-actions><button id=all-learners-btn>Показать всех учащихся</button><button id=group-editor-btn>Редактор группы</button><button style="background-color: #ffc107; color: black;" id=material-manager-btn>Управление материалами</button><button class="super-admin-feature hidden" style="background-color: #17a2b8; color: white;" id=manage-admins-btn>Администраторы</button><button class="super-admin-feature hidden" style="background-color: #343a40; color: white;" id=manage-backups-btn>Управление бэкапами</button><div class="super-admin-feature hidden" id=maintenance-mode-container><label class=maintenance-label for=maintenance-toggle>Режим тестирования</label><label class=switch><input id=maintenance-toggle type=checkbox> <span class="slider round"></span></label></div></div><div class=folders-container id=groups-container></div></div><div class=hidden id=learners-view><div style="display: flex; justify-content: space-between; align-items: center;"><div><button id=back-to-groups-btn>← Назад к группам</button><button id=add-learner-btn>Добавить учащегося</button><button class=btn-secondary id=import-csv-btn>Импорт из CSV</button><button class=btn-secondary id=export-csv-btn>Экспорт в CSV</button><button class=btn-secondary id=import-instructions-btn>Инструкция</button><input accept=.csv class=hidden id=csv-file-input type=file></div><button class="btn-danger hidden" style="margin-right: 10px;" id=delete-selected-btn>Удалить выбранных (0)</button></div><div style="display: flex; gap: 15px; margin-top: 20px; margin-bottom: 10px;" class=filters-container><input placeholder="Поиск по ФИО..." style="flex-grow: 1; margin: 0;" id=search-input><select style="min-width: 200px; font-size: 16px; padding: 10px; border-radius: 8px; border: 1px solid #ccc;" id=group-filter-select><option value>-- Все группы --</select></div><table class=learners-table id=learners-table><thead id=table-head><tr><th style="width: 20px;"><input id=select-all-checkbox type=checkbox><th data-sort-by=full_name>ФИО<th data-sort-by=group_name>Группа<th data-sort-by=login>Логин<th>Действия<tbody id=learners-table-body></table><div id=pagination-container><div class=pagination-wrapper></div></div></div></div><div class="modal-overlay hidden" id=modal><div class=modal-content><div class=modal-header><h2 id=modal-title>Редактировать учащегося</h2><button class=close-btn id=cancel-btn>×</button></div><form id=learner-form><input id=learner-id type=hidden><div class=modal-form-grid><div class=form-group-modal><label for=fullName>ФИО:</label><input id=fullName required></div><div class=form-group-modal><label for=login>Логин:</label><input id=login required></div><div class="form-group-modal grid-col-span-2 password-group password-toggle-container"><label for=password>Новый пароль (оставьте пустым, чтобы не менять):</label><input id=password type=password><span class=password-toggle-icon></span><button title="Сгенерировать пароль" id=generate-password-btn type=button><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg></button></div><div class=form-group-modal><label for=group_name>Группа:</label><input id=group_name required></div><div class=form-group-modal><label for=course>Курс:</label><input id=course required type=number></div><div class=form-group-modal><label for=specialty>Специальность:</label><input id=specialty></div><div class=form-group-modal><label for=enrollmentDate>Дата зачисления:</label><input id=enrollmentDate></div><div class="form-group-modal grid-col-span-2"><label for=sessionSchedule>Расписание сессий:</label><textarea id=sessionSchedule rows=3></textarea></div><div class="form-group-modal grid-col-span-2"><label for=academicDebts>Академические задолженности:</label><textarea id=academicDebts rows=3></textarea></div></div><div class=modal-buttons><button class=btn-primary>Сохранить</button></div></form></div></div><div class="modal-overlay hidden" id=details-modal><div style="max-width: 800px;" class=modal-content><div class=modal-header><h2>Статистика по группам</h2><button class=close-btn id=details-modal-close-btn>×</button></div><table style="width: 100%;" class=learners-table id=groups-stats-table><thead><tr><th>Группа (Специальность)<th>Всего учащихся<th>Должники<tbody id=groups-stats-table-body></table></div></div><div class="modal-overlay hidden" id=group-editor-modal><div class=modal-content><div class=modal-header><h2>Редактор группы</h2><button class=close-btn id=group-editor-close-btn>×</button></div><form id=group-editor-form><div class=modal-form-grid><div class=form-group-modal><label for=group-select>Выберите группу:</label><select id=group-select required><option value>-- Загрузка... --</select></div><div class=form-group-modal><label for=new-group-name>Новый номер группы (оставьте пустым):</label><input placeholder="Например, 218" id=new-group-name></div></div><div class=quick-actions><button id=decrement-course-btn type=button>Понизить курс на -1</button><button id=increment-course-btn type=button>Перевести на +1 курс</button><button id=copy-schedule-btn type=button>Скопировать расписание</button></div><p class=form-hint>Заполните только те поля, которые хотите обновить для всей группы. Пустые поля не будут изменены.<div class=modal-form-grid><div class=form-group-modal><label for=group-course>Курс:</label><input id=group-course type=number></div><div class=form-group-modal><label for=group-specialty>Специальность:</label><input id=group-specialty></div><div class=form-group-modal><label for=group-sessionSchedule>Расписание сессий:</label><textarea id=group-sessionSchedule rows=3></textarea></div><div class=form-group-modal><label for=group-academicDebts>Академические задолженности:</label><textarea id=group-academicDebts rows=3></textarea></div></div><div class=modal-buttons><button class=btn-primary>Обновить группу</button><button class=btn-cancel id=group-editor-cancel-btn type=button>Отмена</button></div></form></div></div><div class="modal-overlay hidden" id=material-manager-modal><div class=modal-content><div class=modal-header><h2>Управление материалами</h2><button class=close-btn id=material-manager-close-btn>×</button></div><form id=material-manager-form><div class=form-group-modal><label for=material-group-select>Выберите группу:</label><select id=material-group-select required><option value>-- Загрузка... --</select></div><div style="margin-top: 20px;" class=hidden id=materials-list-container><h4>Загруженные материалы:</h4><div style="max-height: 200px; overflow-y: auto; border: 1px solid #eee; padding: 10px; border-radius: 6px;" id=current-materials-list><p>Выберите группу для просмотра материалов.</div></div><div style="margin-top: 20px;" class=hidden id=upload-material-container><h4>Загрузить новый материал:</h4><div class=form-group-modal><label for=material-file-input>Выберите PDF файл:</label><input accept=.pdf id=material-file-input required type=file></div><div style="padding-top: 0; border-top: none;" class=modal-buttons><button class=btn-primary>Загрузить</button></div></div></form></div></div><div class="modal-overlay hidden" id=audit-log-modal><div style="max-width: 1000px;" class=modal-content><div class=modal-header><h2>История действий</h2><div><button class="btn-secondary super-admin-feature" style="margin-right: 10px;" id=export-audit-log-btn>Экспорт в CSV</button><button class="btn-danger super-admin-feature" style="margin-right: 10px;" id=clear-audit-log-btn>Очистить логи</button><button class=close-btn id=audit-log-close-btn>×</button></div></div><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; margin-bottom: 20px; align-items: flex-end;" id=audit-filters><div style="margin: 0;" class=form-group-modal><label>Администратор:</label><select id=audit-admin-filter><option value>Все</select></div><div style="margin: 0;" class=form-group-modal><label>Тип действия:</label><select id=audit-action-filter><option value>Все</select></div><div style="margin: 0;" class=form-group-modal><label>Дата с:</label><input id=audit-start-date type=date></div><div style="margin: 0;" class=form-group-modal><label>Дата по:</label><input id=audit-end-date type=date></div><div style="margin: 0; grid-column: span 2;" class=form-group-modal><label>Поиск в описании:</label><input placeholder="Например, имя учащегося или номер группы" id=audit-search-input></div><div><button style="width: 100%; height: 42px;" class=btn-primary id=audit-apply-filters-btn>Применить</button></div><div><button style="width: 100%; height: 42px;" class=btn-cancel id=audit-reset-filters-btn>Сбросить</button></div></div><div style="overflow-x: auto;"><table style="width: 100%;" class=learners-table id=audit-log-table><thead><tr><th>Время<th>Действие<th>Описание<th>Администратор<th class=super-admin-feature>Действия<tbody id=audit-log-table-body></table></div><div style="justify-content: center; margin-top: 20px;" class=pagination-container id=audit-pagination-container><div class=pagination-wrapper></div></div></div></div><div class="modal-overlay hidden" id=backup-manager-modal><div style="max-width: 800px;" class=modal-content><div class=modal-header><h2>Управление резервными копиями</h2><button class=close-btn id=backup-manager-close-btn>×</button></div><p class=form-hint>Автоматическое резервное копирование выполняется каждые 5 часов. Здесь вы можете создать копию вручную или восстановить данные из существующей.</p><button style="margin-bottom: 20px;" class=btn-primary id=create-backup-manual-btn>Создать бэкап сейчас</button><h4>Доступные резервные копии:</h4><div style="max-height: 400px; overflow-y: auto; border: 1px solid #eee; padding: 10px; border-radius: 6px;" id=backup-list-container><p>Загрузка...</div></div></div><div class="modal-overlay hidden" id=manage-admins-modal><div class=modal-content><div class=modal-header><h2>Управление администраторами</h2><button class=close-btn id=manage-admins-close-btn>×</button></div><h4>Добавить администратора</h4><form style="display: flex; gap: 10px; margin-bottom: 20px; align-items: flex-end;" id=add-admin-form><div style="flex-grow: 1;" class=form-group-modal><label>Логин:</label><input id=new-admin-login required></div><div style="flex-grow: 1;" class=form-group-modal><label>Пароль:</label><input id=new-admin-password required type=password></div><button style="height: 42px;" class=btn-primary>Добавить</button></form><h4>Список администраторов</h4><div style="max-height: 300px; overflow-y: auto;"><table style="width: 100%;" id=admins-table><thead><tr><th>Логин<th>Роль<th>Действия<tbody id=admins-table-body></table></div></div></div><div class="modal-overlay hidden" id=sessions-manager-modal><div style="max-width: 1100px;" class=modal-content><div class=modal-header><h2>История сессий пользователей</h2><button class=close-btn id=sessions-manager-close-btn>×</button></div><div style="overflow-x: auto;"><table style="width: 100%;" class=learners-table id=sessions-log-table><thead><tr><th>Статус<th>Пользователь<th>Группа<th>Время входа<th>Последняя активность<th>Время выхода<th>IP-адрес<th>Флаг<tbody id=sessions-log-table-body></table></div><div style="justify-content: center; margin-top: 20px;" class=pagination-container id=sessions-pagination-container><div class=pagination-wrapper></div></div></div></div><div class="modal-overlay hidden" id=debtors-modal><div style="max-width: 900px;" class=modal-content><div class=modal-header><h2>Учащиеся с задолженностями</h2><button class=close-btn id=debtors-modal-close-btn>×</button></div><div style="overflow-x: auto;"><table style="width: 100%;" class=learners-table id=debtors-table><thead><tr><th>ФИО<th>Группа<th>Специальность<th>Задолженность<th>Действия<tbody id=debtors-table-body></table></div></div></div><div id=fab-container><button class="fab super-admin-feature" title="Сессии пользователей" id=fab-session><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg></button><button title="История действий" class=fab id=fab-audit><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg></button></div><script src=admin/app.js type=module></script>